{% extends "main.html" %}

{% block title %}Section Attendance{% if section %} for {{ section }}{% endif %}{% endblock %}

{% block stylesheets %}
    {{ block.super }}
    <link rel="stylesheet" href="/media/styles/forms.css" type="text/css" />
{% endblock %}

{% block content %}
{% load users %}

<h1>Section Attendance{% if section %} for <u>{{ section }}</u>{% endif %}</h1>

<p>
{% if section %}
Here is an attendance sheet for your section's students. Here you can see which students have checked in and submit attendance for your section. This section is scheduled for {{ section.friendly_times_with_date|join:", " }}. If you are looking for a different section, you can select it from the dropdown below.
{% else %}
Please select a section from the dropdown below.
{% endif %}
<br />
</p>

<center>
    <select name="secid" onchange="location.href='/teach/{{ one }}/{{ two }}/section_attendance/'+$j(this).children('option:selected').val()" style="width: 400px;">
        {% if sec != section %}
            <option disabled selected="selected">
                (Select a section)
            </option>
        {% endif %}
        {% for sec in user.taught_sections %}
            <option value="{{ sec.id }}" {% if sec == section %}selected="selected"{% endif %}>
                {{ sec }}: {{ sec.friendly_times_with_date|join:", " }}
            </option>
        {% endfor %}
    </select>
</center>

{% if section %}
<div id="program_form">
<form action="/teach/{{ one }}/{{ two }}/section_attendance/{{ section.id }}" method="post">
<input type="hidden" name="submitted">
<table align="center" width="100%">
<thead>
<tr>
 <th width="5%">
   #
 </th>
 <th width="30%">
  Student Name
 </th>
 <th width="12.5%">
  Student ID #
 </th>
 <th width="12.5%">
  Student Grade
 </th>
 <th width="20%">
  School
 </th>
 <th width="10%">
  Checked In?
 </th>
 <th width="10%">
  Attending Section?
 </th>
</tr>
</thead>
<tbody>
{% for student in section.student_list %}
    <tr>
        <th class="small">{{ forloop.counter }}</th>
        <td>{{ student.name }}</td>
        <td>{{ student.id }}</td>
        <td>{{ student|getGradeForProg:program.id }}</td>
        <td>{{ student.getLastProfile.student_info.getSchool }}</td>
        <td align="center"><input type="checkbox"{% if student.checked_in %} checked{% endif %} disabled></td>
        <td align="center"><input name="attending" value="{{ student.id }}" type="checkbox"{% if student.attended %} checked{% endif %}></td>
    </tr>
{% empty %}
<tr>
    <td colspan="7" align="center">
        No students enrolled in this section
    </td>
</tr>
{% endfor %}
<tr>
    <th colspan="7" align="center">
        Enter any other (unenrolled) students here:
        <br />(as whitespace-separated usernames/user IDs)
    </th>
</tr>
<tr>
    <td colspan = "7" align="center">
        <textarea name="misc_students" rows="10" style="width:75%"></textarea>
        {% if not_found %}
        <br /><span style="color:red">{{ not_found|join:", " }} not found</span>
        {% endif %}
        <br /><input type="checkbox" name="enroll" checked>Enroll these students in this section
        <br /><input type="checkbox" name="unenroll" checked>Unenroll these students from conflicting sections
    </td>
<tr>
    <td colspan = "7" align="center">
        <input type="Submit" class="fancybutton" value="Submit Attendance" /><br />
    </td>
</tr>
</tbody>
</table>
</form>
</div>
{% endif %}

{% endblock %}
