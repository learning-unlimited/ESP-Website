
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>On-Site Schedule Printer</title>
<script type="text/javascript">
<!--

var timer;

function reset_reload()
{
    clearTimeout(timer);
    timer = setTimeout(plain_refresh, 2000);
}

function plain_refresh()
{
    var auto_reload_img = document.getElementById("auto_reload_img");
    if (!auto_reload_img.complete) {
        // if the image hasn't finished loading yet, postpone the next reload another 2s.
        // note: we can't wait for img.onload because that does not fire if the response was empty
        reset_reload();
    } else {
        auto_reload_img.src = '?gen_img&q='+ new Date().getTime();
        reset_reload();
    }
}

function printself() {
   self.focus();
   window.print();
   reset_reload();
}

reset_reload();

//-->
</script>
</head>
<body>
<img id="auto_reload_img" src="?gen_img" onload="javascript:printself();" />
</body>
</html>
