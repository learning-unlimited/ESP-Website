{% extends "main.html" %}

{% block title %}{{program.niceName}} Management{% endblock %}

{% block stylesheets %}
    {{ block.super }}
    <link rel="stylesheet" href="/media/styles/forms.css" type="text/css" />
{% endblock %}

{% block content %}
{% load users %}
<h1>Student Attendance for {{ program.niceName }}</h1>

<div id="program_form">

<p>
{% if timeslot %}
Here is an attendance summary for {{ timeslot }}. Here you can see attendance statistics and details for students that have been checked in during this timeslot, students that are not attending class, and students that are attending classes they were not originally enrolled in. If you are looking for a different timeslot, you can select it from the dropdown below.
{% else %}
Please select a timeslot from the dropdown below.
{% endif %}
<br />
</p>

<center>
    <select name="tsid" onchange="location.href='/onsite/{{ one }}/{{ two }}/attendance/'+$j(this).children('option:selected').val()" style="width: 400px;">
        {% if not timeslot %}
            <option disabled selected="selected">
                (Select a timeslot)
            </option>
        {% endif %}
        {% for ts in program.getTimeSlots %}
            <option value="{{ ts.id }}" {% if ts == timeslot %}selected="selected"{% endif %}>
                {{ ts }}
            </option>
        {% endfor %}
    </select>

<table>
<tr>
    <th width="33%"># Students<br />Checked In<br />To the Program</th>
    <th width="33%"># Students<br />Enrolled in Classes<br />This Timeslot</th>
    <th width="33%"># Students<br />Attending Classes<br />This Timeslot</th>
</tr>
<tr>
    <td align="center">{{ checked_in.count }}</td>
    <td align="center">{{ enrolled.count }}</td>
    <td align="center">{{ attended.count }}</td>
</tr>
</table>
<br />
<table>
<tr>
    <th colspan="6">Students Checked In During This Timeslot</th>
</tr>
<tr>
    <th width="5%">#</th>
    <th width="30%">Student Name</th>
    <th width="15%">Student Username</th>
    <th width="10%">Student ID #</th>
    <th width="10%">Student Grade</th>
    <th width="20%">School</th>
</tr>
{% for student in checked_in_ts %}
<tr>
    <th class="small">{{ forloop.counter }}</th>
    <td>{{ student.name }}</td>
    <td>{{ student.username }}</td>
    <td>{{ student.id }}</td>
    <td>{{ student|getGradeForProg:program.id }}</td>
    <td>{{ student.getLastProfile.student_info.getSchool }}</td>
</tr>
{% empty %}
<tr>
    <td colspan="6" align="center">No students checked in during this timeslot</td>
</tr>
{% endfor %}
</table>
<br />
<table>
<tr>
    <th colspan="6">Students Checked In But Not Attending Class</th>
</tr>
<tr>
    <th width="5%">#</th>
    <th width="30%">Student Name</th>
    <th width="15%">Student Username</th>
    <th width="10%">Student ID #</th>
    <th width="10%">Student Grade</th>
    <th width="20%">School</th>
</tr>
{% for student in not_attending %}
<tr>
    <th class="small">{{ forloop.counter }}</th>
    <td>{{ student.name }}</td>
    <td>{{ student.username }}</td>
    <td>{{ student.id }}</td>
    <td>{{ student|getGradeForProg:program.id }}</td>
    <td>{{ student.getLastProfile.student_info.getSchool }}</td>
</tr>
{% empty %}
<tr>
    <td colspan="6" align="center">No students checked in but not attending class</td>
</tr>
{% endfor %}
</table>
<br />
<table>
<tr>
    <th colspan="6">Students Attending Classes In Which They Weren't Enrolled</th>
</tr>
<tr>
    <th width="5%">#</th>
    <th width="30%">Student Name</th>
    <th width="15%">Student Username</th>
    <th width="10%">Student ID #</th>
    <th width="10%">Student Grade</th>
    <th width="20%">School</th>
</tr>
{% for student in onsite %}
<tr>
    <th class="small">{{ forloop.counter }}</th>
    <td>{{ student.name }}</td>
    <td>{{ student.username }}</td>
    <td>{{ student.id }}</td>
    <td>{{ student|getGradeForProg:program.id }}</td>
    <td>{{ student.getLastProfile.student_info.getSchool }}</td>
</tr>
{% empty %}
<tr>
    <td colspan="6" align="center">No students attending students in which they weren't enrolled</td>
</tr>
{% endfor %}
</table>
</center>

</div>

{% include "program/modules/onsitecore/returnlink.html" %}


{% endblock %}
