<!-- secondary nav -->
<ul id="secondarynav">

{% for nav_entry in navbar_list.qsdTree %}
  <li class="divsecondarynavlink {% if nav_entry.entry.indent %}indent{% endif %}{% if nav_entry.has_bits %} movable{% endif %} " id="nav_entry__{{nav_entry.entry.id}}"> 
      <a href="{{ nav_entry.entry.makeUrl }}"
        title="Click for `{{ nav_entry.entry.makeTitle }}'">
       <span class="bullet">- </span>
        {{ nav_entry.entry.makeTitle }}
      </a>
{% if nav_entry.has_bits %}
<tt>
<span id="nav_entry__control__{{nav_entry.entry.id}}">
<a href="/navbar/edit.scm?new_url={{ request.path }}&amp;navbar_id={{ nav_entry.entry.id }}&amp;node_id={{ navbar_list.entry.node.id }}&amp;action=up">[+]</a>
<a href="/navbar/edit.scm?new_url={{ request.path }}&amp;navbar_id={{ nav_entry.entry.id }}&amp;node_id={{ navbar_list.entry.node.id }}&amp;action=down">[-]</a>
</span>

<a href="/navbar/edit.scm?new_url={{ request.path }}&amp;navbar_id={{ nav_entry.entry.id }}&amp;node_id={{ navbar_list.entry.node.id }}&amp;action=delete" onclick="delete_navbar({{nav_entry.entry.id}}); return false;">[X]</a>
</tt>
{% endif %}
 </li>
{% endfor %}

{% if navbar_list.has_edit_bits %}

<li class="divsecondarynavlink">

<form name="shiftform" method="post" action="/navbar/edit.scm">
Create a new entry:
<input type="hidden" name="new_url" value="{{ request.path }}" />
<input type="hidden" name="section" value="{{ navbar_list.section }}" />
<input type="hidden" name="node_id" value="{{ navbar_list.node.id }}" />
<input type="hidden" name="navbar_id" value="" />
<input type="hidden" name="action" value="new" />
<input name="text" value="Page Name" size="20" />
<input name="url" value="PageURL.html" size="20" />
<select name="indent">
<option value="False">Standard</option>
<option value="True">Indented</option>
</select>
<input name="submit" value="Create!" type="Submit" />
</form>
</li>

<script type="text/javascript">
<!--
dragndrop = function() {
    var Dom = YAHOO.util.Dom;
    var DDM = YAHOO.util.DragDropMgr;
{% for nav_entry in navbar_list.qsdTree %}{% if nav_entry.has_bits %}
    new YAHOO.example.DDList("nav_entry__{{ nav_entry.entry.id }}");
    document.getElementById('nav_entry__control__{{nav_entry.entry.id}}').innerHTML = '';{% endif %}{% endfor %}
    DDM.mode = 0;
};

YAHOO.util.Event.addListener(window, "load", dragndrop);



function delete_navbar(navbar_id) {
   if (!confirm("Are you SURE you want to delete this navbar?")) {
      return;
   }

   var callback = {
    success:function(o) {
       document.getElementById('nav_entry__'+o.argument.nav_entry_id).innerHTML = '';
       document.getElementById('nav_entry__'+o.argument.nav_entry_id).style.display = 'none';
    },
    failure:function(o) {},
    argument: {nav_entry_id: navbar_id}};

   sUrl = '/navbar/edit.scm?new_url={{request.path}}&navbar_id='+navbar_id+'&node_id=&action=delete'

   var request = YAHOO.util.Connect.asyncRequest('GET',sUrl,callback);

}

var handleSuccess = function(o){
   if (o.responseText !== undefined && o.responseText.length > 0) {
      alert(o.responseText);

   }
};

var callback =
{
  success:function(o) {},
  failure:function(o) {},
  argument: {}
};

function move_seq(new_seq) {

   sUrl = '?ajax_movepage&seq='+new_seq;
   //   alert(sUrl);
   var request = YAHOO.util.Connect.asyncRequest('GET',sUrl,callback);
}


//-->
</script>

{% endif %}
<li class="divsecondarynavlink">&nbsp;</li>
</ul>